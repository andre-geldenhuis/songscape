{% extends 'recordings/snippet.html' %}

{% block secondrow %}

{% if id_before %}
<div class="row">
  <div class="span6">
    <ul class="inline">
        {% for tag in tags %}
        <li class="outlined">{{ tag.name }} </li>
        {% endfor %}
    </ul>
  </div>



<div class="col-md-2">
<span class="btn"><a href="{% url 'analysis_snippet' analysis.code next_index  %}">Skip</a></span>
</div>
</div>

{% endif %}

<div class="row">
<div class="col-md-2">
{% if previous_index %}
<span class="btn btn-default"><a href="{% url 'analysis_snippet' analysis.code previous_index %}">&larr; Previous</a></span>
{% endif %}
</div>
<div class="col-md-10">
<form action="{% url 'analysis_snippet' analysis.code index %}" method="post" >{% csrf_token %}
{% for tag in analysis.tags.all %}
<input type="hidden" id="{{ tag.code }}_real" name="{{ tag.code }}" value=false>
<input type="button" class="btn btn-default tag-btn" id="{{ tag.code }}" value="{{ tag.name }}">
{% endfor %}
<input type="hidden" id="null_real" name="null_tag" value=true>
<input type="hidden" name="next_index" value={{ next_index }}>
<input type="hidden" name="snippet" value={{ snippet.id }}>
<input type="submit" class="btn btn-primary" id="null_tag" value="Nothing to be tagged">
</form>
</div>
</div>
{% endblock secondrow %}


{% block extrascript %}

var check_save = function(){
    if ($('.tag-btn').hasClass('btn-success')){
	    $('#null_tag').attr('value', 'Save');
	    $('#null_real').val(false);
    } else {
	    $('#null_tag').attr('value', 'Nothing to be tagged');
	    $('#null_real').val(false);
    };  
};

var deactivate_button = function(){
    $(this).removeClass('btn-success');
    $(this).removeClass('active');
    $('#' + $(this).attr('id') + '_real').val(false);
    check_save();
};

var toggle_button = function(){
    $(this).toggleClass('btn-success');
    $('#' + $(this).attr('id') + '_real').val(
        $(this).hasClass('btn-success')
    );
    check_save();
};

$('.tag-btn:not(#uncertain)').bind('click', function() {
    $(this).each(toggle_button);
    if ($(this).hasClass('btn-success')){
        $('#uncertain').each(deactivate_button);
    };
});

$('#uncertain').bind('click', function() {
    $(this).each(toggle_button);
    if ($('#uncertain_real').val()){
        $('.tag-btn:not(#uncertain)').each(deactivate_button);
    };
});
{% endblock extrascript %}
