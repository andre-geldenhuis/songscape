{% extends 'recordings/snippet.html' %}

{% block secondrow %}

{% if id_before %}
<div class="row">
  <div class="span6">
    <ul class="inline">
        {% for tag in tags %}
        <li class="outlined">{{ tag.name }} </li>
        {% endfor %}
    </ul>
  </div>



<div class="col-md-2">
<span class="btn"><a href="{% url 'analysis_snippet' analysis.code next_index  %}">Skip</a></span>
</div>
</div>

{% endif %}

<div class="row">
<div class="col-md-2">
{% if previous_index %}
<span class="btn btn-default"><a href="{% url 'analysis_snippet' analysis.code previous_index %}">&larr; Previous</a></span>
{% endif %}
</div>
<div class="col-md-10">
<form action="{% url 'analysis_snippet' analysis.code index %}" method="post" >{% csrf_token %}
{% for tag in analysis.tags.all %}
<input type="hidden" id="{{ tag.code }}_real" name="{{ tag.code }}" value=false>
<input type="button" class="btn btn-default tag-btn" id="{{ tag.code }}" value="{{ tag.name }}">
{% endfor %}
<input type="hidden" id="unsure_real" name="unsure" value=false>
<input type="button" class="btn btn-default" id="unsure" value="Not sure">
<input type="hidden" id="null_real" name="null_tag" value=true>
<input type="hidden" name="next_index" value={{ next_index }}>
<input type="submit" class="btn btn-primary" id="null_tag" value="Nothing to be tagged">
</form>
</div>
</div>
{% endblock secondrow %}


{% block extrascript %}

var deactivate_button = function(){
    $(this).removeClass('btn-success');
    $(this).removeClass('active');
    $('#' + $(this).attr('id') + '_real').val(false);
};

var toggle_button = function(){
    $(this).toggleClass('btn-success');
    $('#' + $(this).attr('id') + '_real').val(
        $(this).hasClass('btn-success')
    );
};
    
$('.tag-btn').bind('click', function() {
	$('#null_tag').attr('value', 'Save');
	$('#null_real').val(false);
    $(this).each(toggle_button);
    if ($(this).hasClass('btn-success')){
        $('#unsure').removeClass('btn-success');
        $('#unsure').removeClass('active');
        $('#unsure_real').val(false);
    };
});

$('#unsure').bind('click', function() {
    $(this).each(toggle_button);
	$('#null_tag').attr('value', 'Save');
    if ($('#unsure_real').val()){
        $('.tag-btn').each(deactivate_button);
    };
});
{% endblock extrascript %}
